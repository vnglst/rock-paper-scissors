<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rock Paper Scissors</title>
    <style>
      html {
        height: 100%;
      }

      body {
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100%;
        background: linear-gradient(to bottom, #ff88aa 0%, #2d135f 100%);
      }

      canvas {
        display: block;
        border-radius: 10px;
        overflow: hidden;
        font-family: monospace;
        margin: auto;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        width: min(70vh, 80%);
        max-width: 600px;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas" width="500" height="500"></canvas>
    <script>
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      const size = 150; // Grid size (50x50 for example)
      const cellSize = canvas.width / size;
      let grid = createGrid(size);

      // Initialize the center cells with different types
      let centerX = Math.floor(size / 2);
      let centerY = Math.floor(size / 2);
      grid[centerX][centerY] = 1; // Rock
      grid[centerX + 10][centerY] = 2; // Paper
      grid[centerX][centerY + 10] = 3; // Scissors

      function createGrid(size) {
        return new Array(size).fill(null).map(() => new Array(size).fill(0));
      }

      function drawGrid() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let y = 0; y < size; y++) {
          for (let x = 0; x < size; x++) {
            if (grid[x][y] === 1) {
              ctx.fillStyle = "red"; // Rock
            } else if (grid[x][y] === 2) {
              ctx.fillStyle = "blue"; // Paper
            } else if (grid[x][y] === 3) {
              ctx.fillStyle = "green"; // Scissors
            } else {
              continue;
            }
            ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
          }
        }
      }

      function updateGrid() {
        let newGrid = createGrid(size);
        for (let y = 0; y < size; y++) {
          for (let x = 0; x < size; x++) {
            let direction = getRandomDirection();
            let neighbor = getNeighbor(x, y, direction);
            newGrid[x][y] = determineState(x, y, neighbor);
          }
        }
        grid = newGrid;
      }

      function getRandomDirection() {
        const directions = [
          [-1, 0], // left
          [1, 0], // right
          [0, -1], // up
          [0, 1], // down
        ];
        return directions[Math.floor(Math.random() * directions.length)];
      }

      function getNeighbor(x, y, direction) {
        let nx = x + direction[0];
        let ny = y + direction[1];
        if (nx >= 0 && nx < size && ny >= 0 && ny < size) {
          return grid[nx][ny];
        }
        return null;
      }

      function determineState(x, y, neighbor) {
        const currentState = grid[x][y];

        if (neighbor === null) return currentState; // Edge of the grid

        if (currentState === 0 && neighbor !== 0) {
          return neighbor; // Empty cell takes on the state of the neighbor
        } else if (currentState === 1 && neighbor === 2) {
          return 2; // Rock turns to paper
        } else if (currentState === 2 && neighbor === 3) {
          return 3; // Paper turns to scissors
        } else if (currentState === 3 && neighbor === 1) {
          return 1; // Scissors turn to rock
        }

        return currentState; // Remains the same if no conditions met
      }

      function simulate() {
        updateGrid();
        drawGrid();
        requestAnimationFrame(simulate);
        // setTimeout(() => requestAnimationFrame(simulate), 500);
      }

      simulate();
    </script>
  </body>
</html>
